<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="LIT CTF - rev/minimalist" /><meta property="og:locale" content="en" /><meta name="description" content="Lexington Informatics Tournament CTF 2022 - rev/minimalist" /><meta property="og:description" content="Lexington Informatics Tournament CTF 2022 - rev/minimalist" /><link rel="canonical" href="https://mahmoud-hashad.github.io/posts/litctf-minimalist/" /><meta property="og:url" content="https://mahmoud-hashad.github.io/posts/litctf-minimalist/" /><meta property="og:site_name" content="Mahmoud Ramadan" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-24T18:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="LIT CTF - rev/minimalist" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-07-24T18:00:00+02:00","datePublished":"2022-07-24T18:00:00+02:00","description":"Lexington Informatics Tournament CTF 2022 - rev/minimalist","headline":"LIT CTF - rev/minimalist","mainEntityOfPage":{"@type":"WebPage","@id":"https://mahmoud-hashad.github.io/posts/litctf-minimalist/"},"url":"https://mahmoud-hashad.github.io/posts/litctf-minimalist/"}</script><title>LIT CTF - rev/minimalist | Mahmoud Ramadan</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Mahmoud Ramadan"><meta name="application-name" content="Mahmoud Ramadan"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avatar/avatar.jpeg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Mahmoud Ramadan</a></div><div class="site-subtitle font-italic">Interested in Malware analysis and reverse engineering</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/mahmoud-hashad" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['mahmoud.r.hashad','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/mahmoud-hashad/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>LIT CTF - rev/minimalist</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>LIT CTF - rev/minimalist</h1><div class="post-meta text-muted"><div> By <em> <a href="https://www.linkedin.com/in/mahmoud-hashad/">Mahmoud Ramadan</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1658678400" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-07-24 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="695 words"> <em>3 min</em> read</span></div></div></div><div class="post-content"><h1 id="lexington-informatics-tournament-ctf--2022---revminimalist">Lexington Informatics Tournament CTF 2022 - rev/minimalist</h1><p>Lexington Informatics Tournament CTF 2022 was held from the 22nd of July Until the 25th of the month, and we have participated under the team <a href="https://ctftime.org/team/168238">0xcha0s</a>, we have managed to solve multiple challenges. this challenge was solved 53 times in the 3 days.</p><h2 id="discovering-the-binary"><span class="mr-2">Discovering the binary</span><a href="#discovering-the-binary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>We are given a binary using file command reveals it is an x64bit ELF executable. <img data-src="/assets/img/posts/litctf/img1.png" alt="File command" data-proofer-ignore></p><p>Opening the file in IDA and decompiling the decompiled function looked wired and missing instructions compared to the assembly</p><p><img data-src="/assets/img/posts/litctf/img2.png" alt="ida decompilation" data-proofer-ignore> <img data-src="/assets/img/posts/litctf/img3.png" alt="ida asm" data-proofer-ignore></p><p>And trying ghidra shows a better result on decompilation <img data-src="/assets/img/posts/litctf/img4.png" alt="ghidra decompilation" data-proofer-ignore></p><p>The code can be broke to 3 sections:</p><ol><li>Take the flag from user<li>Doing some operations on the data<li>check if it is a valid flag</ol><p>So let us dive into each one of those</p><h3 id="inputting-the-flag"><span class="mr-2">Inputting the flag</span><a href="#inputting-the-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="n">puts</span><span class="p">(</span><span class="s">"Enter the flag: "</span><span class="p">);</span>
<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mh">0x2f</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">flag_char</span> <span class="o">=</span> <span class="n">getchar</span><span class="p">();</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="o">*</span><span class="p">(</span><span class="n">array</span> <span class="o">+</span> <span class="o">-</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">flag_char</span><span class="p">;</span>
		<span class="n">array</span> <span class="o">-=</span> <span class="mi">8</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="o">*</span><span class="p">(</span><span class="n">array</span> <span class="o">+</span> <span class="o">-</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="o">&amp;</span><span class="n">first_arry</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">8</span><span class="p">);</span>
	<span class="o">*</span><span class="p">(</span><span class="n">array</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0x10</span><span class="p">)</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="o">&amp;</span><span class="n">second_arry</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">8</span><span class="p">);</span>
	<span class="o">*</span><span class="p">(</span><span class="n">array</span> <span class="o">+</span> <span class="o">-</span><span class="mh">0x18</span><span class="p">)</span> <span class="o">=</span> <span class="n">flag_char</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Cleaning the section and analysing it. the input is 47 char length string. the first char will be stored twice, and for each input char, it wil store the char after 2 bytes from 2 arrays on data section. the result of this part is an array where each 3 bytes on this format <code class="language-plaintext highlighter-rouge">&lt;first array byte&gt; &lt;second array byte&gt; &lt;flag_char&gt;</code></p><h3 id="processing-the-flag"><span class="mr-2">Processing the flag</span><a href="#processing-the-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Cleaning the code and it reveals a simple operation using each 3bytes from the result of the last part</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="n">not_flag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mh">0x2f</span><span class="p">;</span> <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">n_1</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="n">n_2</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
    <span class="n">n_3</span> <span class="o">=</span> <span class="n">array</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>

    <span class="n">res</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="n">n_1</span> <span class="o">|</span> <span class="o">~</span><span class="n">n_3</span><span class="p">)</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="o">~</span><span class="n">n_1</span> <span class="o">|</span> <span class="n">n_3</span><span class="p">);</span>
    <span class="n">not_flag</span> <span class="o">=</span> <span class="n">not_flag</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="o">~</span><span class="n">res</span> <span class="o">|</span> <span class="o">~</span><span class="n">n_2</span><span class="p">)</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="n">res</span> <span class="o">|</span> <span class="n">n_2</span><span class="p">);</span>
    <span class="n">array</span> <span class="o">=</span> <span class="n">array</span> <span class="o">+</span> <span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">last_char</span> <span class="o">=</span> <span class="o">*</span><span class="n">array</span><span class="p">;</span>
<span class="n">value</span> <span class="o">=</span> <span class="mh">0xffffffffffffff82</span><span class="p">;</span>
<span class="n">not_flag</span> <span class="o">=</span> <span class="n">not_flag</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="n">last_char</span> <span class="o">|</span> <span class="n">value</span><span class="p">)</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="o">~</span><span class="n">value</span> <span class="o">|</span> <span class="o">~</span><span class="n">last_char</span><span class="p">);</span>
</pre></table></code></div></div><h3 id="flag-check"><span class="mr-2">Flag check</span><a href="#flag-check" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>It will check if the result of the prevouis part is zero</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">if</span> <span class="p">(</span><span class="n">not_flag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"The flag is correct."</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">puts</span><span class="p">(</span><span class="s">"Wrong flag!"</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="solve"><span class="mr-2">Solve</span><a href="#solve" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>dumping the 2 arrays<li>then bute force each char of the flag the will keep <code class="language-plaintext highlighter-rouge">not_flag</code> equal to zero<li>then brute force the last char</ul><div file="main.cpp" class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="main.cpp"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">x</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0xd3</span><span class="p">,</span> <span class="mh">0xcc</span><span class="p">,</span> <span class="mh">0xb5</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span> <span class="mh">0xe0</span><span class="p">,</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0xa1</span><span class="p">,</span> <span class="mh">0xf0</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0xe4</span><span class="p">,</span> <span class="mh">0xe8</span><span class="p">,</span> <span class="mh">0xe4</span><span class="p">,</span> <span class="mh">0x9a</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">,</span> <span class="mh">0xf8</span><span class="p">,</span> <span class="mh">0xe4</span><span class="p">,</span> <span class="mh">0xdd</span><span class="p">,</span> <span class="mh">0x8e</span><span class="p">,</span> <span class="mh">0xda</span><span class="p">,</span> <span class="mh">0xcc</span><span class="p">,</span> <span class="mh">0x9f</span><span class="p">,</span> <span class="mh">0xe8</span><span class="p">,</span> <span class="mh">0xe8</span><span class="p">,</span> <span class="mh">0xab</span><span class="p">,</span> <span class="mh">0xf7</span><span class="p">,</span> <span class="mh">0xb7</span><span class="p">,</span> <span class="mh">0xa5</span><span class="p">,</span> <span class="mh">0xe9</span><span class="p">,</span> <span class="mh">0xf1</span><span class="p">,</span> <span class="mh">0xec</span><span class="p">,</span> <span class="mh">0xfc</span><span class="p">,</span> <span class="mh">0x8a</span><span class="p">,</span> <span class="mh">0x8f</span><span class="p">,</span> <span class="mh">0xe7</span><span class="p">,</span> <span class="mh">0xdd</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0xca</span><span class="p">,</span> <span class="mh">0xfa</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0xea</span><span class="p">,</span> <span class="mh">0xc5</span><span class="p">,</span> <span class="mh">0xa5</span><span class="p">,</span> <span class="mh">0xe9</span><span class="p">,</span> <span class="mh">0xb9</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">};</span>

    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">y</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">,</span> <span class="mh">0x7a</span><span class="p">,</span> <span class="mh">0x1e</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x4b</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x2b</span><span class="p">,</span> <span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x7d</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0x7f</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x7b</span><span class="p">,</span> <span class="mh">0x0d</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x3a</span><span class="p">,</span> <span class="mh">0x7d</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">,</span> <span class="mh">0x0c</span><span class="p">,</span> <span class="mh">0x2f</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x4c</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0x1f</span><span class="p">,</span> <span class="mh">0x1b</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0x3f</span><span class="p">};</span>
    <span class="n">string</span> <span class="n">chars</span> <span class="o">=</span> <span class="s">"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!#$%&amp;</span><span class="se">\'</span><span class="s">()*+,-./:;&lt;=&gt;?@[</span><span class="se">\\</span><span class="s">]^_`{|}~ </span><span class="se">\t\n\r\x0b\x0c</span><span class="s">"</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mh">0x2f</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">chars</span><span class="p">.</span><span class="n">length</span><span class="p">();</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>

            <span class="kt">char</span> <span class="n">n_1</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="kt">char</span> <span class="n">n_2</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="kt">char</span> <span class="n">n_3</span> <span class="o">=</span> <span class="n">chars</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>

            <span class="kt">char</span> <span class="n">not_flag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="kt">char</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

            <span class="n">res</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="n">n_1</span> <span class="o">|</span> <span class="o">~</span><span class="n">n_3</span><span class="p">)</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="o">~</span><span class="n">n_1</span> <span class="o">|</span> <span class="n">n_3</span><span class="p">);</span>
            <span class="n">not_flag</span> <span class="o">=</span> <span class="n">not_flag</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="o">~</span><span class="n">res</span> <span class="o">|</span> <span class="o">~</span><span class="n">n_2</span><span class="p">)</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="n">res</span> <span class="o">|</span> <span class="n">n_2</span><span class="p">);</span>


			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">not_flag</span><span class="p">)</span>
				<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">n_3</span><span class="p">;</span>

      <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">chars</span><span class="p">.</span><span class="n">length</span><span class="p">();</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">char</span> <span class="n">val</span> <span class="o">=</span> <span class="kt">char</span><span class="p">(</span><span class="mh">0xffffffffffffff82</span><span class="p">);</span>
        <span class="kt">char</span> <span class="n">last</span> <span class="o">=</span> <span class="n">chars</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="kt">char</span> <span class="n">not_flag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">not_flag</span> <span class="o">=</span> <span class="n">not_flag</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="n">last</span> <span class="o">|</span> <span class="n">val</span><span class="p">)</span> <span class="o">|</span> <span class="o">~</span><span class="p">(</span><span class="o">~</span><span class="n">val</span> <span class="o">|</span> <span class="o">~</span><span class="n">last</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">not_flag</span><span class="p">)</span>
            <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">last</span><span class="p">;</span>
    <span class="p">}</span>


    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

</pre></table></code></div></div><p>and the flag is <code class="language-plaintext highlighter-rouge">LITCTF{Wh0_n33ds_a11_th0sE_f4ncy_1nstructions?}</code></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/writeup/'>writeup</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/reverse/" class="post-tag no-text-decoration" >reverse</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=LIT CTF - rev/minimalist - Mahmoud Ramadan&amp;url=https://mahmoud-hashad.github.io/posts/litctf-minimalist/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=LIT CTF - rev/minimalist - Mahmoud Ramadan&amp;u=https://mahmoud-hashad.github.io/posts/litctf-minimalist/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://mahmoud-hashad.github.io/posts/litctf-minimalist/&amp;text=LIT CTF - rev/minimalist - Mahmoud Ramadan" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/SolarMarker/">SolarMarker</a><li><a href="/posts/redline_stealer/">RedLine Stealer</a><li><a href="/posts/nahamcon_ctf/">NahamCon CTF 2022</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/reverse/">reverse</a> <a class="post-tag" href="/tags/real-sample/">real_sample</a> <a class="post-tag" href="/tags/net/">.net</a> <a class="post-tag" href="/tags/dll/">dll</a> <a class="post-tag" href="/tags/excel/">excel</a> <a class="post-tag" href="/tags/exe/">exe</a> <a class="post-tag" href="/tags/macro/">macro</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/0x32dbg/">0x32dbg</a> <a class="post-tag" href="/tags/js/">js</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/litctf-You_Know_The_Rules_And_So_Do_I/"><div class="card-body"> <em class="timeago small" data-ts="1658678400" > 2022-07-24 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>LIT CTF - rev/You Know The Rules And So Do I</h3><div class="text-muted small"><p> Lexington Informatics Tournament CTF 2022 - rev/You Know The Rules And So Do I Lexington Informatics Tournament CTF 2022 was held from the 22nd of July Until the 25th of the month, and we have pa...</p></div></div></a></div><div class="card"> <a href="/posts/litctf-codetiger-orz/"><div class="card-body"> <em class="timeago small" data-ts="1658678400" > 2022-07-24 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>LIT CTF - rev/codetiger-orz</h3><div class="text-muted small"><p> Lexington Informatics Tournament CTF 2022 - rev/codetiger-orz Lexington Informatics Tournament CTF 2022 was held from the 22nd of July Until the 25th of the month, and we have participated under t...</p></div></div></a></div><div class="card"> <a href="/posts/ASCWG_1337/"><div class="card-body"> <em class="timeago small" data-ts="1659974400" > 2022-08-08 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ASCWG - rev/Unpacking 1337 [900]</h3><div class="text-muted small"><p> Arab Security Cyber Wargames Qualification Unpacking 1337 The challenge is an elf file called 1 2 &amp;gt; file Akaza Akaza: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, no...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/litctf-codetiger-orz/" class="btn btn-outline-primary" prompt="Older"><p>LIT CTF - rev/codetiger-orz</p></a> <a href="/posts/ASCWG_1337/" class="btn btn-outline-primary" prompt="Newer"><p>ASCWG - rev/Unpacking 1337 [900]</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> Â© 2023 <a href="https://www.linkedin.com/in/mahmoud-hashad/">Mahmoud Ramadan</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/reverse/">reverse</a> <a class="post-tag" href="/tags/real-sample/">real_sample</a> <a class="post-tag" href="/tags/net/">.net</a> <a class="post-tag" href="/tags/dll/">dll</a> <a class="post-tag" href="/tags/excel/">excel</a> <a class="post-tag" href="/tags/exe/">exe</a> <a class="post-tag" href="/tags/macro/">macro</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/0x32dbg/">0x32dbg</a> <a class="post-tag" href="/tags/js/">js</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
