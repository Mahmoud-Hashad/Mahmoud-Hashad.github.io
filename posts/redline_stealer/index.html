<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="RedLine Stealer" /><meta property="og:locale" content="en" /><meta name="description" content="Overview Sample URL: bazaar.abuse" /><meta property="og:description" content="Overview Sample URL: bazaar.abuse" /><link rel="canonical" href="https://mahmoud-hashad.github.io/posts/redline_stealer/" /><meta property="og:url" content="https://mahmoud-hashad.github.io/posts/redline_stealer/" /><meta property="og:site_name" content="Mahmoud Ramadan" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-29T18:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="RedLine Stealer" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-06-06T00:59:01+02:00","datePublished":"2022-05-29T18:00:00+02:00","description":"Overview Sample URL: bazaar.abuse","headline":"RedLine Stealer","mainEntityOfPage":{"@type":"WebPage","@id":"https://mahmoud-hashad.github.io/posts/redline_stealer/"},"url":"https://mahmoud-hashad.github.io/posts/redline_stealer/"}</script><title>RedLine Stealer | Mahmoud Ramadan</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Mahmoud Ramadan"><meta name="application-name" content="Mahmoud Ramadan"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avatar/avatar.jpeg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Mahmoud Ramadan</a></div><div class="site-subtitle font-italic">Interested in Malware analysis and reverse engineering</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/mahmoud-hashad" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['mahmoud.r.hashad','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/mahmoud-hashad/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>RedLine Stealer</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>RedLine Stealer</h1><div class="post-meta text-muted"><div> By <em> <a href="https://www.linkedin.com/in/mahmoud-hashad/">Mahmoud Ramadan</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1653840000" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-29 </em> </span> <span> Updated <em class="timeago" data-ts="1654469941" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-06-06 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1093 words"> <em>6 min</em> read</span></div></div></div><div class="post-content"><h1 id="overview">Overview</h1><p>Sample URL: <a href="https://bazaar.abuse.ch/sample/05d57f5a9de385039f7c3b130325595f176d7181e205681b22a1ad9e4f46951b/">bazaar.abuse</a></p><p><code class="language-plaintext highlighter-rouge">RedLine</code> is a stealer malware that collects all information about the victim as passwords and credit card numbers.</p><p>In this analysis, the goal is to discover the capabilities of the <code class="language-plaintext highlighter-rouge">RedLine</code> and its execution flow. if tarfile.is_tarfile(path):</p><h1 id="basic-static-analysis">Basic Static Analysis</h1><p>Using <code class="language-plaintext highlighter-rouge">Detect-it-easy</code> and <code class="language-plaintext highlighter-rouge">PeID</code>:</p><ul><li>32bit<li>.net executable<li>not packed</ul><p>Checking strings show some clear text this file was not obfuscated</p><h1 id="advanced-static-analysis">Advanced Static Analysis</h1><h2 id="deobfuscation"><span class="mr-2">deobfuscation</span><a href="#deobfuscation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Just to make sure that the file is clear</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>de4dot <span class="nt">-f</span> sample.exe clean_sample.exe
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">de4dot</code> fixed some strings but not the huge deal</p><h2 id="source-code-analyzing"><span class="mr-2">Source Code Analyzing</span><a href="#source-code-analyzing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Opening it int <code class="language-plaintext highlighter-rouge">dnspy</code>. The original EXE name was <code class="language-plaintext highlighter-rouge">happy.exe</code></p><p>Looking at the <code class="language-plaintext highlighter-rouge">main</code> method inside the <code class="language-plaintext highlighter-rouge">program</code> class to start following the execution.</p><p>The first thing it Creates a new object of class <code class="language-plaintext highlighter-rouge">entrypoint</code> inside this class constructor some important values are initialized</p><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">this</span><span class="p">.</span><span class="n">IP</span> <span class="p">=</span> <span class="s">"178.159.38.57:60668"</span><span class="p">;</span>
<span class="k">this</span><span class="p">.</span><span class="n">ID</span> <span class="p">=</span> <span class="s">"build"</span><span class="p">;</span>
<span class="k">this</span><span class="p">.</span><span class="n">Message</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
<span class="k">this</span><span class="p">.</span><span class="n">Key</span> <span class="p">=</span> <span class="s">""</span><span class="p">;</span>
</pre></table></code></div></div><h3 id="connecting-to-c2"><span class="mr-2">Connecting to C2</span><a href="#connecting-to-c2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Then run the <code class="language-plaintext highlighter-rouge">execute</code> method and pass the <code class="language-plaintext highlighter-rouge">entrypoint</code> instance a parameter</p><p>It will try to use the decryption method taking a string and key to get the IP</p><p>The method works as follows</p><ul><li>base64 decode the string<li>xor the decoded string with the key<li>base64 decode the xor string<li>if any exception is raised the original string will be returned</ul><p>And because the <code class="language-plaintext highlighter-rouge">IP</code> is not encrypted it will fail and return the same string</p><p>This method would be important if the <code class="language-plaintext highlighter-rouge">IP</code> was encrypted</p><p>Continue with the function create <code class="language-plaintext highlighter-rouge">EndpointConnection</code> object to create a channel with C2 and check the connection establishment</p><h3 id="recive-setting"><span class="mr-2">Recive Setting</span><a href="#recive-setting" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Send a request to c2 to send the settings that will control the execution flow of the malware</p><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="n">ScanningArgs</span> <span class="n">settings</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ScanningArgs</span><span class="p">();</span>
<span class="k">while</span> <span class="p">(!</span><span class="n">endpointConnection</span><span class="p">.</span><span class="nf">TryGetArgs</span><span class="p">(</span><span class="k">out</span> <span class="n">settings</span><span class="p">))</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(!</span><span class="n">endpointConnection</span><span class="p">.</span><span class="nf">TryGetConnection</span><span class="p">())</span>
  <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nf">Exception</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="n">Thread</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="m">1000</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">ScanningArgs</code> class attributes that will hold the settings</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>ScanBrowsers
ScanFiles
ScanFTP
ScanWallets
ScanScreen
ScanTelegram
ScanVPN
ScanSteam
ScanDiscord
ScanFilesPaths
BlockedCountry
BlockedIP
ScanChromeBrowsersPaths
ScanGeckoBrowsersPaths
</pre></table></code></div></div><h3 id="collect-information"><span class="mr-2">Collect Information</span><a href="#collect-information" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Before starting to collect data the malware check if this device is from the blocked country or blocked IPs that are located in the setting if not it will start gathering all the information</p><p>This is the content of the scan result that will be sent to C2</p><ul><li>Country<li>City<li>IPv4<li>ZipCode<li>Hardware -&gt; md5 hash for <code class="language-plaintext highlighter-rouge">Environment.UserDomainName + Environment.UserName + SystemInfoHelper.GetSerialNumber()</code> and replace <code class="language-plaintext highlighter-rouge">-</code> with space<li>FileLocation -&gt; path of the executed binary<li>Language -&gt; keyboard layouts<li>TimeZone -&gt; timezone :)<li>OSVersion -&gt; windows prodact name + (32 or 64)bit<li>MachineName -&gt; from <code class="language-plaintext highlighter-rouge">Environment.UserName</code><li>ScanDetails<ul><li>SystemHardwares -&gt; List<ul><li>for CPUs and GPUs:<ul><li>Name<li>Counter -&gt; number of cores<li>HardType -&gt; 0 indicate CPU and 1 for GPU</ul><li>for RAM:<ul><li>Name is <code class="language-plaintext highlighter-rouge">Total of RAM</code><li>Counter -&gt; ram size<li>HardType -&gt; 1 same as GPU</ul></ul><li>InstalledBrowsers -&gt; List<ul><li>NameOfBrowser<li>PathOfFile -&gt; absloute path of the browser<li>Version</ul><li>Softwares -&gt; List<ul><li>name[version]</ul><li>SecurityUtils -&gt; List<ul><li>will search at the security center and security center2 for <code class="language-plaintext highlighter-rouge">Antivirus</code>, <code class="language-plaintext highlighter-rouge">Anti-spyware</code> and <code class="language-plaintext highlighter-rouge">Firewall</code> products<li>the list contains the display name of the found product</ul><li>Processes -&gt; List<ul><li>follows this format<li>ID: {Process_Id}, Name: {Process_Name}, Commandline: {commandline that start the process}</ul><li>AvailableLanguages -&gt; List of all installed input languages<li>MessageClientFiles -&gt; List of all files in user desktop<li>Browsers: List<ul><li>BrowserName<li>BrowserProfile<li>Logins -&gt; List<ul><li>URL<li>Username<li>Password</ul><li>Coockies -&gt; List<ul><li>Host<li>Http<li>Path<li>Secure<li>Expires<li>Name<li>Value</ul><li>Autofills -&gt; List<ul><li>Name<li>Value</ul><li>CC -&gt; list of credit cards<ul><li>HolderName<li>Month -&gt; expiration month<li>Year -&gt; expiration year<li>Number</ul></ul><li>ScannedFiles -&gt; List<ul><li>list the files like MessageClientFiles but it retrieves the dirs to scan from <code class="language-plaintext highlighter-rouge">settings.ScanFilesPaths</code></ul><li>FtpConnections -&gt; List<ul><li>URL<li>Username<li>Password</ul><li>ScannedWallets -&gt; List<ul><li>list of all founded wallets<li>supported wallets: Armory, atomic, Coinomi, Electrum, Ethereum, Exodus, Guarda, jaxx, and a general rule to match wallets<li>supported Browser Extensions: Yoroi, Tronlink, NiftyWallet, Metamask, MathWallet, Coinbase, BinanceChain, BraveWallet, GuardaWallet, EqualWallet, JaxxxLiberty, BitAppWallet, iWallet, Wombat, AtomicWallet, Mewcx, GuildWallet, SaturnWallet, RoninWallet</ul><li>GameChatFiles -&gt; List<ul><li>if <code class="language-plaintext highlighter-rouge">settings.ScanDiscord</code> is true<li>contains a list of discord tokens</ul><li>GameLauncherFiles -&gt; List<ul><li>if <code class="language-plaintext highlighter-rouge">settings.ScanSteam</code> is true<li>list of config files of steam</ul><li>Nord<ul><li>if <code class="language-plaintext highlighter-rouge">settings.ScanVPN</code> is true<li>just an empty list</ul><li>Open<ul><li>if <code class="language-plaintext highlighter-rouge">settings.ScanVPN</code> is true<li>for OpenVPN</ul><li>Proton<ul><li>if <code class="language-plaintext highlighter-rouge">settings.ScanVPN</code> is true<li>for ProtonVPN</ul></ul><li>Resolution -&gt; screen size<li>Monitor -&gt; Screenshot of the screen<li>ReleaseID -&gt; for our case <code class="language-plaintext highlighter-rouge">build</code><li>SeenBefore -&gt; check if the directory <code class="language-plaintext highlighter-rouge">{LocalApplicationData}\Yandex\YaAddon</code> exist and if not create it</ul><h3 id="get-remote-tasks"><span class="mr-2">Get Remote Tasks</span><a href="#get-remote-tasks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>After sending the scanned data. <code class="language-plaintext highlighter-rouge">RedLine</code> Check if there was any update.</p><p>include those 4 methods</p><ul><li>CommandLineUpdate<li>DownloadUpdate<li>DownloadAndExecuteUpdate<li>OpenUpdate</ul><h1 id="advanced-dynamic-analysis">Advanced Dynamic Analysis</h1><p>Running the sample at <a href="https://any.run/">any.run</a></p><p>It sends 4 requests to C2 as shown in the figure</p><p><img data-src="/assets/img/posts/redline/connections.png" alt="C2-connections" data-proofer-ignore> <em>C2 Connections</em></p><p>Examining the requests <code class="language-plaintext highlighter-rouge">redline</code> uses <code class="language-plaintext highlighter-rouge">SOAP</code> protocol to communicate with C2 and the data is sent as <code class="language-plaintext highlighter-rouge">XML</code>.</p><p><img data-src="/assets/img/posts/redline/checkconn.png" alt="checkconn" data-proofer-ignore> <em>Check connection request</em></p><h2 id="settings"><span class="mr-2">Settings</span><a href="#settings" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Inspecting the second request that retrieves settings and examining the response</p><p>You can check the file from <a href="/assets/img/posts/redline/settings.xml">here</a></p><p>The settings for this sample are</p><div file="settengs" class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="settengs"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
</pre><td class="rouge-code"><pre><span class="n">ScanBrowsers</span> <span class="p">=</span> <span class="k">true</span>
<span class="n">ScanFiles</span> <span class="p">=</span> <span class="k">true</span>
<span class="n">ScanFTP</span> <span class="p">=</span> <span class="k">true</span>
<span class="n">ScanWallets</span> <span class="p">=</span> <span class="k">true</span>
<span class="n">ScanScreen</span> <span class="p">=</span> <span class="k">true</span>
<span class="n">ScanTelegram</span> <span class="p">=</span> <span class="k">true</span>
<span class="n">ScanVPN</span> <span class="p">=</span> <span class="k">true</span>
<span class="n">ScanSteam</span> <span class="p">=</span> <span class="k">true</span>
<span class="n">ScanDiscord</span> <span class="p">=</span> <span class="k">true</span>
<span class="n">ScanFilesPaths</span> <span class="p">=</span> <span class="p">[</span>
    <span class="s">"%userprofile%\Desktop|*.txt,*.doc*,*key*,*wallet*,*seed*|0"</span><span class="p">,</span>
    <span class="s">"%userprofile%\Documents|*.txt,*.doc*,*key*,*wallet*,*seed*|0"</span>
<span class="p">]</span>
<span class="n">BlockedCountry</span> <span class="p">=</span> <span class="p">[]</span>
<span class="n">BlockedIP</span> <span class="p">=</span> <span class="p">[]</span>
<span class="n">ScanChromeBrowsersPaths</span> <span class="p">=</span> <span class="p">[</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Battle.net"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Chromium\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Google\Chrome\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Google(x86)\Chrome\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Roaming\Opera Software\",
</span>    <span class="s">"%USERPROFILE%\AppData\Local\MapleStudio\ChromePlus\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Iridium\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\7Star\7Star\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\CentBrowser\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Chedot\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Vivaldi\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Kometa\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Elements Browser\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Epic Privacy Browser\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\uCozMedia\Uran\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Fenrir Inc\Sleipnir5\setting\modules\ChromiumViewer"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\CatalinaGroup\Citrio\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Coowon\Coowon\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\liebao\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\QIP Surf\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Orbitum\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Comodo\Dragon\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Amigo\User\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Torch\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Yandex\YandexBrowser\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Comodo\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\360Browser\Browser\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Maxthon3\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\K-Melon\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Sputnik\Sputnik\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Nichrome\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\CocCoc\Browser\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Uran\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Chromodo\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Mail.Ru\Atom\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\BraveSoftware\Brave-Browser\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Microsoft\Edge\User Data"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\NVIDIA Corporation\NVIDIA GeForce Experience"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\Steam"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Local\CryptoTab Browser\User Data"</span>
<span class="p">]</span>
<span class="n">ScanGeckoBrowsersPaths</span> <span class="p">=</span> <span class="p">[</span>
    <span class="s">"%USERPROFILE%\AppData\Roaming\Waterfox"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Roaming\K-Meleon"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Roaming\Thunderbird"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Roaming\Comodo\IceDragon"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Roaming\8pecxstudios\Cyberfox"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Roaming\NETGATE Technologies\BlackHaw"</span><span class="p">,</span>
    <span class="s">"%USERPROFILE%\AppData\Roaming\Moonchild Productions\Pale Moon"</span>
<span class="p">]</span>
</pre></table></code></div></div><h2 id="scan-results"><span class="mr-2">Scan Results</span><a href="#scan-results" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Looking at the third request that send 1.5MB Most of the data are the base64 encoded screenshot</p><p>Nothing was new all of the sent data was discussed before</p><p>You can check the file from <a href="/assets/img/posts/redline/scan_result.xml">here</a></p><h2 id="remote-tasks"><span class="mr-2">Remote Tasks</span><a href="#remote-tasks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Analyzing the last request. No remote tasks were returned</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/malware/'>Malware</a>, <a href='/categories/spyware/'>Spyware</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/real-sample/" class="post-tag no-text-decoration" >real_sample</a> <a href="/tags/net/" class="post-tag no-text-decoration" >.net</a> <a href="/tags/exe/" class="post-tag no-text-decoration" >exe</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=RedLine Stealer - Mahmoud Ramadan&amp;url=https://mahmoud-hashad.github.io/posts/redline_stealer/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=RedLine Stealer - Mahmoud Ramadan&amp;u=https://mahmoud-hashad.github.io/posts/redline_stealer/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://mahmoud-hashad.github.io/posts/redline_stealer/&amp;text=RedLine Stealer - Mahmoud Ramadan" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/SolarMarker/">SolarMarker</a><li><a href="/posts/redline_stealer/">RedLine Stealer</a><li><a href="/posts/nahamcon_ctf/">NahamCon CTF 2022</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/reverse/">reverse</a> <a class="post-tag" href="/tags/real-sample/">real_sample</a> <a class="post-tag" href="/tags/net/">.net</a> <a class="post-tag" href="/tags/dll/">dll</a> <a class="post-tag" href="/tags/excel/">excel</a> <a class="post-tag" href="/tags/exe/">exe</a> <a class="post-tag" href="/tags/macro/">macro</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/0x32dbg/">0x32dbg</a> <a class="post-tag" href="/tags/js/">js</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/SolarMarker/"><div class="card-body"> <em class="timeago small" data-ts="1683648000" > 2023-05-09 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>SolarMarker</h3><div class="text-muted small"><p> Initial assessment Using pestudio MD5: ed629af9a127724d64185a26d00ae62d File type: 32bit .NET DLL Compiler stamp: Mon Feb 22 17:24:02 2021 | UTC entry point: 0x0002BECE Imports some import...</p></div></div></a></div><div class="card"> <a href="/posts/Unpacking_Loki/"><div class="card-body"> <em class="timeago small" data-ts="1683907200" > 2023-05-12 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Unpaking Loki</h3><div class="text-muted small"><p> Initial Assessment Sample Info: MD5: b66eb4bcb2860ef48afbc1378e1ae545 File Type: PE32 Compiler Time Stamp: 2016-03-29 23:03:35 Sections contains abnormal section name Imports a lot of susp...</p></div></div></a></div><div class="card"> <a href="/posts/vjw0rm/"><div class="card-body"> <em class="timeago small" data-ts="1657814400" > 2022-07-14 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Vjw0rm</h3><div class="text-muted small"><p> Vjw0rm Sample Url: https://bazaar.abuse.ch/ We start with a js file the file is obfuscated as shown in the image and at the end is some data that looks like base64 encoded but if you try to deco...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/acnologia_portal/" class="btn btn-outline-primary" prompt="Older"><p>Acnologia Portal - Cyber Apocalypse CTF 2022</p></a> <a href="/posts/emu8068_1/" class="btn btn-outline-primary" prompt="Newer"><p>Patching emu8086</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://www.linkedin.com/in/mahmoud-hashad/">Mahmoud Ramadan</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/reverse/">reverse</a> <a class="post-tag" href="/tags/real-sample/">real_sample</a> <a class="post-tag" href="/tags/net/">.net</a> <a class="post-tag" href="/tags/dll/">dll</a> <a class="post-tag" href="/tags/excel/">excel</a> <a class="post-tag" href="/tags/exe/">exe</a> <a class="post-tag" href="/tags/macro/">macro</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/0x32dbg/">0x32dbg</a> <a class="post-tag" href="/tags/js/">js</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
