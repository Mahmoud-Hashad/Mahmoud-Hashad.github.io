<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="LIT CTF - rev/You Know The Rules And So Do I" /><meta property="og:locale" content="en" /><meta name="description" content="Lexington Informatics Tournament CTF 2022 - rev/You Know The Rules And So Do I" /><meta property="og:description" content="Lexington Informatics Tournament CTF 2022 - rev/You Know The Rules And So Do I" /><link rel="canonical" href="https://mahmoud-hashad.github.io/posts/litctf-You_Know_The_Rules_And_So_Do_I/" /><meta property="og:url" content="https://mahmoud-hashad.github.io/posts/litctf-You_Know_The_Rules_And_So_Do_I/" /><meta property="og:site_name" content="Mahmoud Ramadan" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-24T18:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="LIT CTF - rev/You Know The Rules And So Do I" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-07-24T18:00:00+02:00","datePublished":"2022-07-24T18:00:00+02:00","description":"Lexington Informatics Tournament CTF 2022 - rev/You Know The Rules And So Do I","headline":"LIT CTF - rev/You Know The Rules And So Do I","mainEntityOfPage":{"@type":"WebPage","@id":"https://mahmoud-hashad.github.io/posts/litctf-You_Know_The_Rules_And_So_Do_I/"},"url":"https://mahmoud-hashad.github.io/posts/litctf-You_Know_The_Rules_And_So_Do_I/"}</script><title>LIT CTF - rev/You Know The Rules And So Do I | Mahmoud Ramadan</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Mahmoud Ramadan"><meta name="application-name" content="Mahmoud Ramadan"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avatar/avatar.jpeg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Mahmoud Ramadan</a></div><div class="site-subtitle font-italic">Interested in Malware analysis and reverse engineering</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/mahmoud-hashad" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['mahmoud.r.hashad','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/mahmoud-hashad/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>LIT CTF - rev/You Know The Rules And So Do I</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>LIT CTF - rev/You Know The Rules And So Do I</h1><div class="post-meta text-muted"><div> By <em> <a href="https://www.linkedin.com/in/mahmoud-hashad/">Mahmoud Ramadan</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1658678400" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-07-24 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="692 words"> <em>3 min</em> read</span></div></div></div><div class="post-content"><h1 id="lexington-informatics-tournament-ctf--2022---revyou-know-the-rules-and-so-do-i">Lexington Informatics Tournament CTF 2022 - rev/You Know The Rules And So Do I</h1><p>Lexington Informatics Tournament CTF 2022 was held from the 22nd of July Until the 25th of the month, and we have participated under the team 0xcha0s, we have managed to solve multiple challenges. this challenge was solved 10 times in the 3 days.</p><p>Were are given 2 files one is an executable and the other is a BMP image</p><h2 id="discovering-the-binary"><span class="mr-2">Discovering the binary</span><a href="#discovering-the-binary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>We were given an x64bit ELF executable. My first thought is that the binary has hidden the flag inside the image and I will need to reverse this process.</p><p>And by decompiling the main function and analysing it:</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="c1">// open the file</span>
<span class="n">stream</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">"flag.txt"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">stream</span> <span class="p">)</span>
<span class="p">{</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">"Error: The flag file does not exist"</span><span class="p">);</span>
	<span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// read the flag</span>
<span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">fread</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span> <span class="mh">0x32uLL</span><span class="p">,</span> <span class="mi">1uLL</span><span class="p">,</span> <span class="n">stream</span><span class="p">)</span> <span class="p">)</span>
<span class="p">{</span>
	<span class="n">puts</span><span class="p">(</span><span class="s">"Error: The flag is too short"</span><span class="p">);</span>
	<span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// convert it to bits array</span>
<span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">49</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
<span class="p">{</span>
	<span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="mi">7</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span>
	  <span class="n">v22</span><span class="p">[</span><span class="mi">8</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(((</span><span class="kt">int</span><span class="p">)(</span><span class="kt">unsigned</span> <span class="kr">__int8</span><span class="p">)</span><span class="n">ptr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">7</span> <span class="o">-</span> <span class="n">j</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>It will open <code class="language-plaintext highlighter-rouge">flag.txt</code> and read the flag then convert it to an array of bits.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">v20</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">"yougotrickrolled.bmp"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">);</span>
<span class="n">v21</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">"yougotrickrolledChallenge.bmp"</span><span class="p">,</span> <span class="s">"w"</span><span class="p">);</span>
</pre></table></code></div></div><p>Then will open 2 files one contains the original image to read and the other will be written to it.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">for</span> <span class="p">(</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="mi">137</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span> <span class="p">)</span>
<span class="p">{</span>
	<span class="n">fread</span><span class="p">(</span><span class="o">&amp;</span><span class="n">v5</span><span class="p">,</span> <span class="mi">1uLL</span><span class="p">,</span> <span class="mi">1uLL</span><span class="p">,</span> <span class="n">v20</span><span class="p">);</span>
	<span class="n">fputc</span><span class="p">(</span><span class="n">v5</span><span class="p">,</span> <span class="n">v21</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Then write the first 137 bytes without any changes.</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="k">for</span> <span class="p">(</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">m</span> <span class="o">&lt;=</span> <span class="mi">799</span><span class="p">;</span> <span class="o">++</span><span class="n">m</span> <span class="p">)</span>
<span class="p">{</span>
	<span class="k">for</span> <span class="p">(</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">1199</span><span class="p">;</span> <span class="o">++</span><span class="n">n</span> <span class="p">)</span>
	<span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span> <span class="n">ii</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">ii</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">;</span> <span class="o">++</span><span class="n">ii</span> <span class="p">)</span>
			<span class="n">fread</span><span class="p">(</span><span class="o">&amp;</span><span class="n">grid</span><span class="p">[</span><span class="mi">3600</span> <span class="o">*</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="n">ii</span><span class="p">],</span> <span class="mi">1uLL</span><span class="p">,</span> <span class="mi">1uLL</span><span class="p">,</span> <span class="n">v20</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Then load the rest of the image in an array where <code class="language-plaintext highlighter-rouge">m</code> is the width and <code class="language-plaintext highlighter-rouge">n</code> is the height and <code class="language-plaintext highlighter-rouge">ii</code> is the color channel</p><div class="language-cpp highlighter-rouge"><div class="code-header"> <span data-label-text="Cpp"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="n">v12</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">v13</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">v14</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span> <span class="n">jj</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">jj</span> <span class="o">&lt;=</span> <span class="mi">399</span><span class="p">;</span> <span class="o">++</span><span class="n">jj</span> <span class="p">)</span>
<span class="p">{</span>
	<span class="n">alter</span><span class="p">(</span><span class="o">&amp;</span><span class="n">grid</span><span class="p">[</span><span class="mi">3600</span> <span class="o">*</span> <span class="n">v12</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">v13</span><span class="p">],</span> <span class="n">v14</span><span class="p">,</span> <span class="n">v22</span><span class="p">[</span><span class="n">jj</span><span class="p">]);</span>
	<span class="n">v3</span> <span class="o">=</span> <span class="n">v14</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">v14</span> <span class="o">=</span> <span class="p">(</span><span class="n">v14</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">24</span><span class="p">;</span>
	<span class="n">v14</span> <span class="o">=</span> <span class="n">v3</span> <span class="o">-</span> <span class="mi">24</span> <span class="o">*</span> <span class="n">v14</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span> <span class="n">v22</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span> <span class="p">)</span>
		<span class="o">++</span><span class="n">v12</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="o">++</span><span class="n">v13</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="nf">alter</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="o">*</span><span class="n">grid_element</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="n">flag_bit</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">unsigned</span> <span class="kr">__int8</span> <span class="o">*</span><span class="n">result</span><span class="p">;</span> <span class="c1">// rax</span>

  <span class="n">result</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">grid_element</span><span class="p">[</span><span class="n">a2</span> <span class="o">/</span> <span class="mi">8</span><span class="p">];</span>
  <span class="o">*</span><span class="n">result</span> <span class="o">^=</span> <span class="p">(</span><span class="n">flag_bit</span> <span class="o">^</span> <span class="p">(((</span><span class="kt">int</span><span class="p">)</span><span class="o">*</span><span class="n">result</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="n">a2</span> <span class="o">%</span> <span class="mi">8</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">))</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">a2</span> <span class="o">%</span> <span class="mi">8</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Now to the interesting part it will loop over our flag and change the <code class="language-plaintext highlighter-rouge">ith</code> bit at the color channel with the flag bit the bit index will increment each loop and the color channel will increment every 8 bits (single char).</p><p>If the written bit is one will change the width offset and if not will change the height offset.</p><p>And after all of this writing the new byte to the output image.</p><h2 id="solver-script"><span class="mr-2">Solver script</span><a href="#solver-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre><td class="rouge-code"><pre><span class="n">image</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"yougotrickrolledChallenge.bmp"</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">)</span>
<span class="n">image_data</span> <span class="o">=</span> <span class="n">image</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">image_data</span> <span class="o">=</span> <span class="n">image_data</span><span class="p">[</span><span class="mi">138</span><span class="p">:]</span>


<span class="n">flag</span> <span class="o">=</span> <span class="s">''</span>
<span class="n">flag_byte</span> <span class="o">=</span> <span class="s">''</span>
<span class="n">color_channel_index</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">408</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">8</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">flag</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">flag_byte</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">flag_byte</span> <span class="o">=</span> <span class="s">''</span>
        <span class="n">color_channel_index</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">image_byte</span> <span class="o">=</span> <span class="n">image_data</span><span class="p">[</span><span class="mi">3600</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">color_channel_index</span> <span class="o">%</span> <span class="mi">3</span><span class="p">)]</span>
    <span class="n">flag_bit</span> <span class="o">=</span> <span class="n">image_byte</span> <span class="o">&amp;</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">8</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">flag_bit</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">flag_byte</span> <span class="o">+=</span> <span class="s">'1'</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">flag_byte</span> <span class="o">+=</span> <span class="s">'0'</span>



<span class="k">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</pre></table></code></div></div><p>flag <code class="language-plaintext highlighter-rouge">LITCTF{h0n3stly_im_n0t_sur3_1f_rick_r0ll3d_mys3lf}</code></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/writeup/'>writeup</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/reverse/" class="post-tag no-text-decoration" >reverse</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=LIT CTF - rev/You Know The Rules And So Do I - Mahmoud Ramadan&amp;url=https://mahmoud-hashad.github.io/posts/litctf-You_Know_The_Rules_And_So_Do_I/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=LIT CTF - rev/You Know The Rules And So Do I - Mahmoud Ramadan&amp;u=https://mahmoud-hashad.github.io/posts/litctf-You_Know_The_Rules_And_So_Do_I/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://mahmoud-hashad.github.io/posts/litctf-You_Know_The_Rules_And_So_Do_I/&amp;text=LIT CTF - rev/You Know The Rules And So Do I - Mahmoud Ramadan" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/SolarMarker/">SolarMarker</a><li><a href="/posts/redline_stealer/">RedLine Stealer</a><li><a href="/posts/nahamcon_ctf/">NahamCon CTF 2022</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/reverse/">reverse</a> <a class="post-tag" href="/tags/real-sample/">real_sample</a> <a class="post-tag" href="/tags/net/">.net</a> <a class="post-tag" href="/tags/dll/">dll</a> <a class="post-tag" href="/tags/excel/">excel</a> <a class="post-tag" href="/tags/exe/">exe</a> <a class="post-tag" href="/tags/macro/">macro</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/0x32dbg/">0x32dbg</a> <a class="post-tag" href="/tags/js/">js</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/litctf-codetiger-orz/"><div class="card-body"> <em class="timeago small" data-ts="1658678400" > 2022-07-24 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>LIT CTF - rev/codetiger-orz</h3><div class="text-muted small"><p> Lexington Informatics Tournament CTF 2022 - rev/codetiger-orz Lexington Informatics Tournament CTF 2022 was held from the 22nd of July Until the 25th of the month, and we have participated under t...</p></div></div></a></div><div class="card"> <a href="/posts/litctf-minimalist/"><div class="card-body"> <em class="timeago small" data-ts="1658678400" > 2022-07-24 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>LIT CTF - rev/minimalist</h3><div class="text-muted small"><p> Lexington Informatics Tournament CTF 2022 - rev/minimalist Lexington Informatics Tournament CTF 2022 was held from the 22nd of July Until the 25th of the month, and we have participated under the...</p></div></div></a></div><div class="card"> <a href="/posts/ASCWG_1337/"><div class="card-body"> <em class="timeago small" data-ts="1659974400" > 2022-08-08 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ASCWG - rev/Unpacking 1337 [900]</h3><div class="text-muted small"><p> Arab Security Cyber Wargames Qualification Unpacking 1337 The challenge is an elf file called 1 2 &amp;gt; file Akaza Akaza: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, no...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/vjw0rm/" class="btn btn-outline-primary" prompt="Older"><p>Vjw0rm</p></a> <a href="/posts/litctf-codetiger-orz/" class="btn btn-outline-primary" prompt="Newer"><p>LIT CTF - rev/codetiger-orz</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://www.linkedin.com/in/mahmoud-hashad/">Mahmoud Ramadan</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/reverse/">reverse</a> <a class="post-tag" href="/tags/real-sample/">real_sample</a> <a class="post-tag" href="/tags/net/">.net</a> <a class="post-tag" href="/tags/dll/">dll</a> <a class="post-tag" href="/tags/excel/">excel</a> <a class="post-tag" href="/tags/exe/">exe</a> <a class="post-tag" href="/tags/macro/">macro</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/0x32dbg/">0x32dbg</a> <a class="post-tag" href="/tags/js/">js</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
