<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="NahamCon CTF 2022" /><meta property="og:locale" content="en" /><meta name="description" content="Web Personnel" /><meta property="og:description" content="Web Personnel" /><link rel="canonical" href="https://mahmoud-hashad.github.io/posts/nahamcon_ctf/" /><meta property="og:url" content="https://mahmoud-hashad.github.io/posts/nahamcon_ctf/" /><meta property="og:site_name" content="Mahmoud Ramadan" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-04-30T18:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="NahamCon CTF 2022" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-02T19:45:39+02:00","datePublished":"2022-04-30T18:00:00+02:00","description":"Web Personnel","headline":"NahamCon CTF 2022","mainEntityOfPage":{"@type":"WebPage","@id":"https://mahmoud-hashad.github.io/posts/nahamcon_ctf/"},"url":"https://mahmoud-hashad.github.io/posts/nahamcon_ctf/"}</script><title>NahamCon CTF 2022 | Mahmoud Ramadan</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Mahmoud Ramadan"><meta name="application-name" content="Mahmoud Ramadan"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avatar/avatar.jpeg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Mahmoud Ramadan</a></div><div class="site-subtitle font-italic">Interested in Malware analysis and reverse engineering</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/mahmoud-hashad" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['mahmoud.r.hashad','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/in/mahmoud-hashad/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>NahamCon CTF 2022</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 200'%3E%3C/svg%3E" data-src="/assets/img/posts/nahamctf/naham_banner.png" class="preview-img bg" alt="naham banner" width="500" height="200" data-proofer-ignore><h1 data-toc-skip>NahamCon CTF 2022</h1><div class="post-meta text-muted"><div> By <em> <a href="https://www.linkedin.com/in/mahmoud-hashad/">Mahmoud Ramadan</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1651334400" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-04-30 </em> </span> <span> Updated <em class="timeago" data-ts="1651513539" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-02 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1791 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><h1 id="web">Web</h1><h2 id="personnel"><span class="mr-2">Personnel</span><a href="#personnel" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/assets/img/posts/nahamctf/personnel_des.jpeg" alt="challange-description" data-proofer-ignore> <em>challange description</em></p><div file="app.py" class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="app.py"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="n">flag</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"flag.txt"</span><span class="p">).</span><span class="n">read</span><span class="p">()</span>
<span class="n">users</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"users.txt"</span><span class="p">).</span><span class="n">read</span><span class="p">()</span>

<span class="n">users</span> <span class="o">+=</span> <span class="n">flag</span>


<span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">"/"</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">"GET"</span><span class="p">,</span> <span class="s">"POST"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">"GET"</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">"lookup.html"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="n">method</span> <span class="o">==</span> <span class="s">"POST"</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">[</span><span class="s">"name"</span><span class="p">]</span>
        <span class="n">setting</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">[</span><span class="s">"setting"</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">isupper</span><span class="p">():</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="n">results</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s">"[A-Z][a-z]*?"</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="sa">r</span><span class="s">"[a-z]*?\n"</span><span class="p">,</span> <span class="n">users</span><span class="p">,</span> <span class="n">setting</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">results</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">"lookup.html"</span><span class="p">,</span> <span class="n">passed_results</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="n">results</span><span class="p">)</span>
</pre></table></code></div></div><p>The name is concatenated and used as regex for search for a pattern so by entering the name as <code class="language-plaintext highlighter-rouge">|flag{.*}|</code></p><p>It will return all the strings any string starting with a capital letter followed by any number of small letters or flag format or word consisting of small letters</p><p><img data-src="/assets/img/posts/nahamctf/personnel_flag.jpeg" alt="challange-flag" data-proofer-ignore> <em>query results</em></p><blockquote class="prompt-info"><div><p>flag{f0e659b45b507d8633065bbd2832c627}</p></div></blockquote><h1 id="reverse">Reverse</h1><h2 id="babyrev"><span class="mr-2">babyrev</span><a href="#babyrev" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/assets/img/posts/nahamctf/babyrev_des.jpeg" alt="challange-description" data-proofer-ignore> <em>challange description</em></p><p>looking at the elf file</p><div filename="main" class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>   <span class="n">v6</span> <span class="o">=</span> <span class="n">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"Welcome to baby's first rev! :&gt;</span><span class="se">\n</span><span class="s">Please enter your username: "</span><span class="p">);</span>
  <span class="n">__isoc99_scanf</span><span class="p">(</span><span class="s">"%s"</span><span class="p">,</span> <span class="n">s1</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"Please enter your password: "</span><span class="p">);</span>
  <span class="n">__isoc99_scanf</span><span class="p">(</span><span class="s">"%s"</span><span class="p">,</span> <span class="n">v5</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">strcmp</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="s">"bossbaby"</span><span class="p">)</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"%s? I don't know you... stranger danger..."</span><span class="p">,</span> <span class="n">s1</span><span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"You're almost there!"</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">sub_12AD</span><span class="p">(</span><span class="n">v5</span><span class="p">)</span> <span class="o">==</span> <span class="mi">38</span> <span class="p">)</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"You're boss baby!"</span><span class="p">);</span>
</pre></table></code></div></div><p>username is <code class="language-plaintext highlighter-rouge">babyboss</code> and the password is passed to Subroutine <code class="language-plaintext highlighter-rouge">sub_12AD</code></p><p>The important part of this function is a call to function <code class="language-plaintext highlighter-rouge">sub_1208 + 1</code> then it compares the data stored at <code class="language-plaintext highlighter-rouge">dword_4020</code> with the password</p><div filename="sub_12AD" class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre> <span class="p">((</span><span class="kt">void</span> <span class="p">(</span><span class="kr">__fastcall</span> <span class="o">*</span><span class="p">)())((</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">sub_1208</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))();</span>
  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
  <span class="p">{</span>
    <span class="n">v4</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">v4</span> <span class="o">&gt;=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="p">)</span>
      <span class="k">break</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">dword_4020</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">v11</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="p">)</span>
      <span class="o">++</span><span class="n">v8</span><span class="p">;</span>
  <span class="p">}</span>
</pre></table></code></div></div><p>this address wasnâ€™t recognized as code so you have to make a function at this location</p><div filename="sub_120D" class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">__int64</span> <span class="kr">__fastcall</span> <span class="nf">sub_120D</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">a1</span><span class="p">,</span> <span class="n">__int64</span> <span class="n">a2</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [rsp+1Ch] [rbp-14h]</span>

  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">strlen</span><span class="p">(</span><span class="n">a1</span><span class="p">);</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>
    <span class="o">*</span><span class="p">(</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)(</span><span class="mi">4LL</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">a1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="p">((</span><span class="kt">char</span><span class="p">)</span><span class="n">i</span> <span class="o">%</span> <span class="mi">7</span><span class="p">))</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="n">i</span><span class="p">;</span>
  <span class="k">return</span> <span class="n">a2</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>extract bytes at <code class="language-plaintext highlighter-rouge">dword_4020</code> and reverse the encryption done by <code class="language-plaintext highlighter-rouge">sub_120D</code></p><div file="solver.py" class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="solver.py"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="n">arr</span> <span class="o">=</span>  <span class="p">[</span><span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x0D9</span><span class="p">,</span> <span class="mh">0x188</span><span class="p">,</span> <span class="mh">0x341</span><span class="p">,</span> <span class="mh">0x7C0</span><span class="p">,</span> <span class="mh">0x6F9</span><span class="p">,</span> <span class="mh">0x18A4</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0x10A</span><span class="p">,</span>
 <span class="mh">0x1D5</span><span class="p">,</span> <span class="mh">0x37C</span><span class="p">,</span> <span class="mh">0x3A9</span><span class="p">,</span> <span class="mh">0x7B0</span><span class="p">,</span> <span class="mh">0x1969</span><span class="p">,</span> <span class="mh">0x127</span><span class="p">,</span> <span class="mh">0x1A3</span><span class="p">,</span> <span class="mh">0x1C4</span><span class="p">,</span> <span class="mh">0x2B9</span><span class="p">,</span>
 <span class="mh">0x754</span><span class="p">,</span> <span class="mh">0x889</span><span class="p">,</span> <span class="mh">0x0F50</span><span class="p">,</span> <span class="mh">0x1F0</span><span class="p">,</span> <span class="mh">0x254</span><span class="p">,</span> <span class="mh">0x2D9</span><span class="p">,</span> <span class="mh">0x558</span><span class="p">,</span> <span class="mh">0x571</span><span class="p">,</span> <span class="mh">0x924</span><span class="p">,</span>
 <span class="mh">0x1019</span><span class="p">,</span> <span class="mh">0x342</span><span class="p">,</span> <span class="mh">0x3AD</span><span class="p">,</span> <span class="mh">0x508</span><span class="p">,</span> <span class="mh">0x6E9</span><span class="p">,</span> <span class="mh">0x0A30</span><span class="p">,</span> <span class="mh">0x10E1</span><span class="p">,</span> <span class="mh">0x1284</span><span class="p">,</span>
 <span class="mh">0x500</span><span class="p">,</span> <span class="mh">0x5D2</span><span class="p">,</span> <span class="mh">0x74D</span><span class="p">,]</span>

<span class="n">flag</span> <span class="o">=</span> <span class="s">''</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">)):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">7</span><span class="p">)</span>
    <span class="n">flag</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>


<span class="k">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>flag{7bdeac39cca13a97782c04522aece87a}</p></div></blockquote><h1 id="mobile">Mobile</h1><h2 id="otp-vault"><span class="mr-2">OTP Vault</span><a href="#otp-vault" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/assets/img/posts/nahamctf/otp_vault_des.jpeg" alt="challange-description" data-proofer-ignore> <em>challange description</em></p><p>opening APK at JADX-GUI and looking at the main activity</p><div file="MainActivity" class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="MainActivity"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">com.otpvault</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.facebook.react.ReactActivity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.facebook.react.ReactActivityDelegate</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.facebook.react.ReactRootView</span><span class="o">;</span>

<span class="cm">/* loaded from: classes.dex */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="nc">ReactActivity</span> <span class="o">{</span>
    <span class="nd">@Override</span> <span class="c1">// com.facebook.react.ReactActivity</span>
    <span class="kd">protected</span> <span class="nc">String</span> <span class="nf">getMainComponentName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"OTPVault"</span><span class="o">;</span>
    <span class="o">}</span>

</pre></table></code></div></div><p>the main activity inherits from <code class="language-plaintext highlighter-rouge">ReactActivity</code> this means the apk build using react-native</p><p>running apktool to extract all files from APK</p><div class="language-shell nolineno highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>apktool d OTPVault.apk
</pre></table></code></div></div><p>looking at the code at <code class="language-plaintext highlighter-rouge">OTPVault.ap/assets/index.android.bundle</code> a search for otp then copy a few lines and prettify it</p><div file="javascript" class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="javascript"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="kd">function</span> <span class="nx">O</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">n</span><span class="p">;</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">e</span><span class="p">.</span><span class="k">default</span><span class="p">)(</span><span class="k">this</span><span class="p">,</span> <span class="nx">O</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">o</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span> <span class="nx">u</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">o</span><span class="p">),</span> <span class="nx">l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">l</span> <span class="o">&lt;</span> <span class="nx">o</span><span class="p">;</span> <span class="nx">l</span><span class="o">++</span><span class="p">)</span> <span class="nx">u</span><span class="p">[</span><span class="nx">l</span><span class="p">]</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="nx">l</span><span class="p">];</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">n</span> <span class="o">=</span> <span class="nx">b</span><span class="p">.</span><span class="nx">call</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span> <span class="p">[</span><span class="k">this</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">u</span><span class="p">))).</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">output</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Insert your OTP to unlock your vault</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">text</span><span class="p">:</span> <span class="dl">''</span>
    <span class="p">},</span> <span class="nx">n</span><span class="p">.</span><span class="nx">s</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">JJ2XG5CIMFRWW2LOM4</span><span class="dl">'</span><span class="p">,</span> <span class="nx">n</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">http://congon4tor.com:7777</span><span class="dl">'</span><span class="p">,</span> <span class="nx">n</span><span class="p">.</span><span class="nx">token</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">652W8NxdsHFTorqLXgo=</span><span class="dl">'</span><span class="p">,</span>

    <span class="nx">n</span><span class="p">.</span><span class="nx">getFlag</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">e</span><span class="p">,</span> <span class="nx">o</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">t</span><span class="p">.</span><span class="k">default</span><span class="p">.</span><span class="k">async</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">u</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(;;)</span> <span class="k">switch</span> <span class="p">(</span><span class="nx">u</span><span class="p">.</span><span class="nx">prev</span> <span class="o">=</span> <span class="nx">u</span><span class="p">.</span><span class="nx">next</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">case</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="nx">u</span><span class="p">.</span><span class="nx">prev</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
                            <span class="na">Authorization</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Bearer KMGQ0YTYgIMTk5Mjc2NzZY4OMjJlNzAC0WU2DgiYzE41ZDwN</span><span class="dl">'</span>
                        <span class="p">}</span>
                    <span class="p">},</span> <span class="nx">u</span><span class="p">.</span><span class="nx">next</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="nx">t</span><span class="p">.</span><span class="k">default</span><span class="p">.</span><span class="nx">awrap</span><span class="p">(</span><span class="nx">p</span><span class="p">.</span><span class="k">default</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">n</span><span class="p">.</span><span class="nx">url</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">/flag</span><span class="dl">"</span><span class="p">,</span> <span class="nx">e</span><span class="p">));</span>
                <span class="k">case</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="nx">o</span> <span class="o">=</span> <span class="nx">u</span><span class="p">.</span><span class="nx">sent</span><span class="p">,</span> <span class="nx">n</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
                        <span class="na">output</span><span class="p">:</span> <span class="nx">o</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">flag</span>
<span class="c1">//                     }), u.next = 12;</span>
</pre></table></code></div></div><p>sending the same request using postman</p><p><img data-src="/assets/img/posts/nahamctf/postman.jpeg" alt="postman_request" data-proofer-ignore> <em>postman request</em></p><blockquote class="prompt-info"><div><p>flag{5450384e093a0444e6d3d39795dd7ddd}</p></div></blockquote><h2 id="secure-notes"><span class="mr-2">Secure Notes</span><a href="#secure-notes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/assets/img/posts/nahamctf/secure_note_des.jpeg" alt="challange-description" data-proofer-ignore> <em>challange description</em></p><p>opening the APK in JADX-GUI and looking at login activity</p><p>the APK takes a pin code and repeats it 4 times then use it as a key for AES encryption to decrypt the database</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="nc">View</span> <span class="n">view</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="nc">C0940d</span><span class="o">.</span><span class="na">m156k</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">f2153b</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">()</span> <span class="o">+</span> <span class="k">this</span><span class="o">.</span><span class="na">f2153b</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">()</span> <span class="o">+</span> <span class="k">this</span><span class="o">.</span><span class="na">f2153b</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">()</span> <span class="o">+</span> <span class="k">this</span><span class="o">.</span><span class="na">f2153b</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">(),</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">f2154c</span><span class="o">.</span><span class="na">getPath</span><span class="o">()),</span> <span class="k">new</span> <span class="nc">File</span><span class="o">(</span><span class="nc">LoginActivity</span><span class="o">.</span><span class="na">this</span><span class="o">.</span><span class="na">getCacheDir</span><span class="o">(),</span> <span class="s">"notes.db"</span><span class="o">));</span>
        <span class="nc">LoginActivity</span><span class="o">.</span><span class="na">this</span><span class="o">.</span><span class="na">startActivity</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">f2155d</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">C0947a</span> <span class="n">unused</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="nc">LoginActivity</span><span class="o">.</span><span class="na">this</span><span class="o">.</span><span class="na">getApplicationContext</span><span class="o">(),</span> <span class="s">"Wrong password"</span><span class="o">,</span> <span class="mi">0</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">m156k</span><span class="o">(</span><span class="nc">String</span> <span class="n">str</span><span class="o">,</span> <span class="nc">File</span> <span class="n">file</span><span class="o">,</span> <span class="nc">File</span> <span class="n">file2</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
        <span class="nc">SecretKeySpec</span> <span class="n">secretKeySpec</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SecretKeySpec</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(),</span> <span class="s">"AES"</span><span class="o">);</span>
        <span class="nc">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="nc">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"AES"</span><span class="o">);</span>
        <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">secretKeySpec</span><span class="o">);</span>
        <span class="nc">FileInputStream</span> <span class="n">fileInputStream</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileInputStream</span><span class="o">(</span><span class="n">file</span><span class="o">);</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">bArr</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[(</span><span class="kt">int</span><span class="o">)</span> <span class="n">file</span><span class="o">.</span><span class="na">length</span><span class="o">()];</span>
        <span class="n">fileInputStream</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">bArr</span><span class="o">);</span>
        <span class="kt">byte</span><span class="o">[]</span> <span class="n">doFinal</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">bArr</span><span class="o">);</span>
        <span class="nc">FileOutputStream</span> <span class="n">fileOutputStream</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="n">file2</span><span class="o">);</span>
        <span class="n">fileOutputStream</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">doFinal</span><span class="o">);</span>
        <span class="n">fileInputStream</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">fileOutputStream</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="o">|</span> <span class="nc">InvalidKeyException</span> <span class="o">|</span> <span class="nc">NoSuchAlgorithmException</span> <span class="o">|</span> <span class="nc">BadPaddingException</span> <span class="o">|</span> <span class="nc">IllegalBlockSizeException</span> <span class="o">|</span> <span class="nc">NoSuchPaddingException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">C0947a</span><span class="o">(</span><span class="s">"Error encrypting/decrypting file"</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>writing script to brute force all keys and save the decrypted File</p><div file="Main.java" class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Main.java"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileInputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.FileOutputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.InvalidKeyException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.security.NoSuchAlgorithmException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.WeakHashMap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.BadPaddingException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.Cipher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.IllegalBlockSizeException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.NoSuchPaddingException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.crypto.spec.SecretKeySpec</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Path</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.nio.file.Paths</span><span class="o">;</span>


<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span> <span class="n">args</span><span class="o">[])</span> <span class="o">{</span>

        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i1</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i1</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i1</span><span class="o">++)</span> <span class="o">{</span>
            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i2</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i2</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i2</span><span class="o">++)</span> <span class="o">{</span>
                <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i3</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i3</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i3</span><span class="o">++)</span> <span class="o">{</span>
                    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i4</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i4</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i4</span><span class="o">++)</span> <span class="o">{</span>
                        <span class="nc">String</span> <span class="n">code</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">i1</span><span class="o">)</span> <span class="o">+</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">i2</span><span class="o">)</span> <span class="o">+</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">i3</span><span class="o">)</span> <span class="o">+</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">i4</span><span class="o">);</span>
                        <span class="nc">String</span> <span class="n">str</span> <span class="o">=</span> <span class="n">code</span> <span class="o">+</span> <span class="n">code</span> <span class="o">+</span> <span class="n">code</span> <span class="o">+</span> <span class="n">code</span><span class="o">;</span>
                        <span class="nc">String</span> <span class="n">file</span> <span class="o">=</span> <span class="s">"./db.encrypted"</span><span class="o">;</span>
                        <span class="nc">String</span> <span class="n">file2</span> <span class="o">=</span> <span class="s">"./"</span> <span class="o">+</span> <span class="n">code</span> <span class="o">+</span> <span class="s">".db"</span><span class="o">;</span>
                        <span class="c1">// System.out.println("Trying value: " + code);</span>
                        <span class="k">try</span> <span class="o">{</span>
                            <span class="nc">SecretKeySpec</span> <span class="n">secretKeySpec</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SecretKeySpec</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(),</span> <span class="s">"AES"</span><span class="o">);</span>
                            <span class="nc">Cipher</span> <span class="n">cipher</span> <span class="o">=</span> <span class="nc">Cipher</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="s">"AES"</span><span class="o">);</span>
                            <span class="n">cipher</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="n">secretKeySpec</span><span class="o">);</span>
                            <span class="c1">// FileInputStream fileInputStream = new FileInputStream(file);</span>
                            <span class="c1">// byte[] bArr = new byte[(int) file.length()];</span>
                            <span class="c1">// fileInputStream.read(bArr);</span>

                            <span class="nc">Path</span> <span class="n">path</span> <span class="o">=</span> <span class="nc">Paths</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"./db.encrypted"</span><span class="o">);</span>
                            <span class="kt">byte</span><span class="o">[]</span> <span class="n">bArr</span> <span class="o">=</span> <span class="n">java</span><span class="o">.</span><span class="na">nio</span><span class="o">.</span><span class="na">file</span><span class="o">.</span><span class="na">Files</span><span class="o">.</span><span class="na">readAllBytes</span><span class="o">(</span><span class="n">path</span><span class="o">);</span>
                            <span class="c1">// System.out.println("Found value: " + bArr.length);</span>
                            <span class="kt">byte</span><span class="o">[]</span> <span class="n">doFinal</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="na">doFinal</span><span class="o">(</span><span class="n">bArr</span><span class="o">);</span>
                            <span class="nc">FileOutputStream</span> <span class="n">fileOutputStream</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="n">file2</span><span class="o">);</span>
                            <span class="n">fileOutputStream</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">doFinal</span><span class="o">);</span>
                            <span class="c1">// fileInputStream.close();</span>
                            <span class="n">fileOutputStream</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
                            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Found value: "</span> <span class="o">+</span> <span class="n">code</span><span class="o">);</span>
                            <span class="k">break</span><span class="o">;</span>
                        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="o">|</span> <span class="nc">InvalidKeyException</span> <span class="o">|</span> <span class="nc">NoSuchAlgorithmException</span> <span class="o">|</span> <span class="nc">BadPaddingException</span> <span class="o">|</span> <span class="nc">IllegalBlockSizeException</span> <span class="o">|</span> <span class="nc">NoSuchPaddingException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                            <span class="c1">// System.out.println(e);</span>
                        <span class="o">}</span>


                    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>

    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>this script will generate many files and by running file command only one of them will be defined as JSON with correct pin <code class="language-plaintext highlighter-rouge">5732</code></p><blockquote class="prompt-info"><div><p>flag{a5f6f2f861cb52b98ebedcc7c7094354}</p></div></blockquote><h2 id="click-me"><span class="mr-2">Click Me</span><a href="#click-me" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/assets/img/posts/nahamctf/click_me_des.jpeg" alt="challange-description" data-proofer-ignore> <em>challange description</em></p><p>opening the apk in JADX-GUI and looking at the Main activity</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>
<span class="kd">public</span> <span class="kd">final</span> <span class="kt">void</span> <span class="nf">cookieViewClick</span><span class="o">(</span><span class="nc">View</span> <span class="n">view</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">CLICKS</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
    <span class="k">this</span><span class="o">.</span><span class="na">CLICKS</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">13371337</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">CLICKS</span> <span class="o">=</span> <span class="mi">13371337</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="o">((</span><span class="nc">TextView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="no">C0574R</span><span class="o">.</span><span class="na">C0577id</span><span class="o">.</span><span class="na">cookieCount</span><span class="o">)).</span><span class="na">setText</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">CLICKS</span><span class="o">));</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">final</span> <span class="kt">void</span> <span class="nf">getFlagButtonClick</span><span class="o">(</span><span class="nc">View</span> <span class="n">view</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Intrinsics</span><span class="o">.</span><span class="na">checkNotNullParameter</span><span class="o">(</span><span class="n">view</span><span class="o">,</span> <span class="s">"view"</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">CLICKS</span> <span class="o">==</span> <span class="mi">99999999</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">getApplicationContext</span><span class="o">(),</span> <span class="n">getFlag</span><span class="o">(),</span> <span class="mi">0</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
        <span class="k">return</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="nc">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">getApplicationContext</span><span class="o">(),</span> <span class="s">"You do not have enough cookies to get the flag"</span><span class="o">,</span> <span class="mi">0</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
<span class="o">}</span>
</pre></table></code></div></div><p>it is not possible to get a 99999999 click</p><p>using apktool</p><div class="language-shell nolineno highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>apktool d click_me.apk
</pre></table></code></div></div><p>and change the value 99999999 to 5 at smali bytecode and set <code class="language-plaintext highlighter-rouge">extractNativeLibs</code> as <code class="language-plaintext highlighter-rouge">true</code> at <code class="language-plaintext highlighter-rouge">AndroidManifest</code></p><p>then compile the patched APK</p><div class="language-shell nolineno highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>apktool.exe b click_me/ <span class="nt">-o</span> flag.apk
</pre></table></code></div></div><p>then create signature key and sign the APK to run it</p><div class="language-shell nolineno highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>keytool <span class="nt">-genkey</span> <span class="nt">-v</span> <span class="nt">-keystore</span> my-release-key.keystore <span class="nt">-alias</span> alias_name <span class="nt">-keyalg</span> RSA <span class="nt">-keysize</span> 2048 <span class="nt">-validity</span> 10000

jarsigner <span class="nt">-verbose</span> <span class="nt">-sigalg</span> SHA1withRSA <span class="nt">-digestalg</span> SHA1 <span class="nt">-keystore</span> my-release-key.keystore flag.apk alias_name
</pre></table></code></div></div><p>run apk, click at the cookie 5 time at click get flag button</p><blockquote class="prompt-info"><div><p>flag{849d9e5421c59358ee4d568adebc5a70)</p></div></blockquote><h1 id="malware">Malware</h1><h2 id="ottos-it"><span class="mr-2">Ottoâ€™s It</span><a href="#ottos-it" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/assets/img/posts/nahamctf/otto_it.jpeg" alt="challange-description" data-proofer-ignore> <em>challange description</em></p><p>DetectItEasy identify the file as an AutoIt script</p><p><img data-src="/assets/img/posts/nahamctf/autoit_die.jpeg" alt="DetectItEasy" data-proofer-ignore> <em>DetectItEasy</em></p><p>using AutoIt extractor to get the script</p><p><img data-src="/assets/img/posts/nahamctf/autoit_extractor.jpeg" alt="autoit-extractor" data-proofer-ignore> <em>autoit extractor</em></p><p>Analyzing the script</p><p>The script is obsticated but from the description you can think about clip board as malware might change the value copied to mactch the attacker wallet address and thatis how he steal the money</p><p>Seach for Clipboard you will find a function read clipBoard and compare it to some varibles but thier value isnâ€™t clear so i modified the code after each variable to pop up a message box with it value ex</p><pre><code class="language-autoit">MsgBox(0,"",$ckkgdnbk_rowmg_zlwyizjakm)

MsgBox(0,"",$var_2025)

MsgBox(0,"",$var_2571)

MsgBox(0,"",$rmkily_bsqta)
</code></pre><p>and cmpiled the file and after few message box here is the flag <img data-src="/assets/img/posts/nahamctf/autoit_flag.jpeg" alt="flag" data-proofer-ignore> <em>flag</em></p><blockquote class="prompt-info"><div><p>flag{f4bc6d0bfcbf128c97490e392a39842b}</p></div></blockquote><h2 id="usb-drive"><span class="mr-2">USB Drive</span><a href="#usb-drive" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/assets/img/posts/nahamctf/usb_drive_des.jpeg" alt="challange-description" data-proofer-ignore> <em>challange description</em></p><p>Open the LNK as a text file found a lot of empty lines and at the end, this command appears to fetch some data from a URL</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>CMD&lt;ttps://tinyurl.com/a7ba6ma
</pre></table></code></div></div><p>the link point to some encoded data <img data-src="/assets/img/posts/nahamctf/usb_stage2.jpeg" alt="stage2" data-proofer-ignore> <em>stage2</em></p><p>decode it from base 32</p><p><img data-src="/assets/img/posts/nahamctf/usb_stage2_decode.jpeg" alt="cyberchef" data-proofer-ignore> <em>base32 cyberchef</em></p><p>The decoded file is a DLL.</p><p>The analysis reveals that DllMain will show the flag at a message box</p><p>run the dll</p><div class="language-shell nolineno highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>rundll32.exe stage2.dll,DllMain
</pre></table></code></div></div><p><img data-src="/assets/img/posts/nahamctf/usb_flag.jpeg" alt="flag" data-proofer-ignore> <em>flag</em></p><blockquote class="prompt-info"><div><p>flag{0af2873a74cfa957ccb90cef814cfe3d}</p></div></blockquote><h1 id="miscellaneous">Miscellaneous</h1><h2 id="one-mantissa-please"><span class="mr-2">One Mantissa Please</span><a href="#one-mantissa-please" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/assets/img/posts/nahamctf/1_mantissa_plz.jpeg" alt="challange-description" data-proofer-ignore> <em>challange description</em></p><p>from this link <a href="https://indepth.dev/posts/1139/here-is-what-you-need-to-know-about-javascripts-number-type">javascripts number type</a> <code class="language-plaintext highlighter-rouge">9007199254740992 IS equal to 9007199254740993</code></p><blockquote class="prompt-info"><div><p>flag{3a78300a68de2a1210c9e3726c3cb87a}</p></div></blockquote><h2 id="to-be-and-not-to-be"><span class="mr-2">To Be And Not To Be</span><a href="#to-be-and-not-to-be" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/assets/img/posts/nahamctf/nan_des.jpeg" alt="challange-description" data-proofer-ignore> <em>challange description</em></p><p>in javascript NaN != NaN</p><blockquote class="prompt-info"><div><p>flag{7ecfb3bf076a6a9635f975fe96ac97fd}</p></div></blockquote><h1 id="steganography">Steganography</h1><h2 id="ostrich"><span class="mr-2">Ostrich</span><a href="#ostrich" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/assets/img/posts/nahamctf/ostrich.jpeg" alt="challange-description" data-proofer-ignore> <em>challange description</em></p><p>The script will load the image and loop over each char of the flag to find a random pixel and multiply the char of the flag with the third color value of the pixel the store then result in the pixel and save the image</p><p>In the end, all images are converted to one apng image</p><p>Writing a script that will loop over each frame of the apng and found the different pixel and get the flag</p><div file="solver.py" class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="solver.py"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">imageio</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">GifImagePlugin</span>
<span class="kn">from</span> <span class="nn">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span> <span class="k">as</span> <span class="n">l2b</span><span class="p">,</span> <span class="n">bytes_to_long</span> <span class="k">as</span> <span class="n">b2l</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">apng</span> <span class="kn">import</span> <span class="n">APNG</span>

<span class="n">filenames</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">flag</span> <span class="o">=</span> <span class="s">'x'</span> <span class="o">*</span> <span class="mi">32</span>

<span class="n">orig_filename</span> <span class="o">=</span> <span class="s">"ostrich.jpg"</span>
<span class="n">orig_image</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nb">open</span><span class="p">(</span><span class="n">orig_filename</span><span class="p">)</span>

<span class="n">pixels</span> <span class="o">=</span> <span class="n">orig_image</span><span class="p">.</span><span class="n">load</span><span class="p">()</span>

<span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="n">orig_image</span><span class="p">.</span><span class="n">size</span>

<span class="n">images</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">flag</span> <span class="o">=</span> <span class="s">''</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">APNG</span><span class="p">.</span><span class="nb">open</span><span class="p">(</span><span class="s">"result.apng"</span><span class="p">)</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">frame</span><span class="p">,</span> <span class="n">control</span> <span class="ow">in</span> <span class="n">im</span><span class="p">.</span><span class="n">frames</span><span class="p">:</span>
    <span class="n">frame</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"frame.png"</span><span class="p">)</span>
    <span class="n">png</span> <span class="o">=</span> <span class="n">Image</span><span class="p">.</span><span class="nb">open</span><span class="p">(</span><span class="s">"frame.png"</span><span class="p">)</span>

    <span class="n">png_pixels</span> <span class="o">=</span> <span class="n">png</span><span class="p">.</span><span class="n">load</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">height</span><span class="p">):</span>
            <span class="n">pixel</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">png</span><span class="p">.</span><span class="n">getpixel</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">pixel</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">pixel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">orig_image</span><span class="p">.</span><span class="n">getpixel</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">pixel</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                    <span class="k">if</span> <span class="n">pixel</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">orig_image</span><span class="p">.</span><span class="n">getpixel</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">b</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">pixel</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

                    <span class="n">l</span> <span class="o">=</span> <span class="n">b2l</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
                    <span class="n">flag</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">l</span> <span class="o">/</span> <span class="n">orig_image</span><span class="p">.</span><span class="n">getpixel</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))[</span><span class="mi">2</span><span class="p">]))</span>

<span class="k">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>flag{d3a5b80f96a3ce0dd0aedbefbc6b1fa1}</p></div></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ctf/'>CTF</a>, <a href='/categories/writeup/'>writeup</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/mobile/" class="post-tag no-text-decoration" >mobile</a> <a href="/tags/malware/" class="post-tag no-text-decoration" >malware</a> <a href="/tags/reverse/" class="post-tag no-text-decoration" >reverse</a> <a href="/tags/miscellaneous/" class="post-tag no-text-decoration" >miscellaneous</a> <a href="/tags/steganography/" class="post-tag no-text-decoration" >steganography</a> <a href="/tags/web/" class="post-tag no-text-decoration" >web</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=NahamCon CTF 2022 - Mahmoud Ramadan&amp;url=https://mahmoud-hashad.github.io/posts/nahamcon_ctf/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=NahamCon CTF 2022 - Mahmoud Ramadan&amp;u=https://mahmoud-hashad.github.io/posts/nahamcon_ctf/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://mahmoud-hashad.github.io/posts/nahamcon_ctf/&amp;text=NahamCon CTF 2022 - Mahmoud Ramadan" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/SolarMarker/">SolarMarker</a><li><a href="/posts/redline_stealer/">RedLine Stealer</a><li><a href="/posts/nahamcon_ctf/">NahamCon CTF 2022</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/reverse/">reverse</a> <a class="post-tag" href="/tags/real-sample/">real_sample</a> <a class="post-tag" href="/tags/net/">.net</a> <a class="post-tag" href="/tags/dll/">dll</a> <a class="post-tag" href="/tags/excel/">excel</a> <a class="post-tag" href="/tags/exe/">exe</a> <a class="post-tag" href="/tags/macro/">macro</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/0x32dbg/">0x32dbg</a> <a class="post-tag" href="/tags/js/">js</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/litctf-You_Know_The_Rules_And_So_Do_I/"><div class="card-body"> <em class="timeago small" data-ts="1658678400" > 2022-07-24 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>LIT CTF - rev/You Know The Rules And So Do I</h3><div class="text-muted small"><p> Lexington Informatics Tournament CTF 2022 - rev/You Know The Rules And So Do I Lexington Informatics Tournament CTF 2022 was held from the 22nd of July Until the 25th of the month, and we have pa...</p></div></div></a></div><div class="card"> <a href="/posts/litctf-codetiger-orz/"><div class="card-body"> <em class="timeago small" data-ts="1658678400" > 2022-07-24 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>LIT CTF - rev/codetiger-orz</h3><div class="text-muted small"><p> Lexington Informatics Tournament CTF 2022 - rev/codetiger-orz Lexington Informatics Tournament CTF 2022 was held from the 22nd of July Until the 25th of the month, and we have participated under t...</p></div></div></a></div><div class="card"> <a href="/posts/litctf-minimalist/"><div class="card-body"> <em class="timeago small" data-ts="1658678400" > 2022-07-24 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>LIT CTF - rev/minimalist</h3><div class="text-muted small"><p> Lexington Informatics Tournament CTF 2022 - rev/minimalist Lexington Informatics Tournament CTF 2022 was held from the 22nd of July Until the 25th of the month, and we have participated under the...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <a href="/posts/acnologia_portal/" class="btn btn-outline-primary" prompt="Newer"><p>Acnologia Portal - Cyber Apocalypse CTF 2022</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> Â© 2023 <a href="https://www.linkedin.com/in/mahmoud-hashad/">Mahmoud Ramadan</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/reverse/">reverse</a> <a class="post-tag" href="/tags/real-sample/">real_sample</a> <a class="post-tag" href="/tags/net/">.net</a> <a class="post-tag" href="/tags/dll/">dll</a> <a class="post-tag" href="/tags/excel/">excel</a> <a class="post-tag" href="/tags/exe/">exe</a> <a class="post-tag" href="/tags/macro/">macro</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/0x32dbg/">0x32dbg</a> <a class="post-tag" href="/tags/js/">js</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
